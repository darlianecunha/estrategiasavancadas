<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Milhas ‚Äî Grupo de Estrat√©gias Avan√ßadas (Hub por T√≥picos)</title>
<meta name="description" content="P√°gina est√°tica por t√≥picos com links de interesse: estrat√©gias, programas, ferramentas, promo√ß√µes, comunidades e tutoriais." />
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3E‚úàÔ∏è%3C/text%3E%3C/svg%3E">
<style>
  :root{
    --bg:#0b1220; --card:#101a2b; --text:#e7eef8; --muted:#a9b8d0; --brand:#4cc9f0;
    --chip:#17263e; --chip-b:#243758; --link:#8be1ff; --stroke:#21324f;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue","Noto Sans",sans-serif}
  a{color:var(--link);text-decoration:none} a:hover{text-decoration:underline}
  .container{max-width:1200px;margin:0 auto;padding:22px}
  header{display:flex;align-items:center;gap:14px;justify-content:space-between;flex-wrap:wrap}
  .hgroup{display:flex;gap:10px;align-items:center}
  h1{margin:0;font-size:clamp(20px,3.6vw,28px)}
  .sub{color:var(--muted);font-size:14px;margin-top:2px}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap}
  .btn{background:var(--chip);border:1px solid var(--chip-b);color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
  .btn.brand{background:linear-gradient(90deg,#3a86ff,#4cc9f0);border:none}
  .searchbar{display:flex;gap:8px;align-items:center;background:var(--card);border:1px solid var(--stroke);border-radius:12px;padding:8px 12px;margin:14px 0}
  .searchbar input{flex:1;background:transparent;border:none;color:var(--text);outline:none}
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 6px}
  .tab{padding:8px 12px;border-radius:999px;background:var(--chip);border:1px solid var(--chip-b);cursor:pointer;font-size:14px}
  .tab.active{background:var(--brand);color:#001018;border-color:transparent}
  .chips{display:flex;gap:6px;flex-wrap:wrap;margin:6px 0 2px}
  .chip{font-size:12px;padding:6px 10px;border-radius:999px;background:#11203a;border:1px solid #243758;color:var(--muted);cursor:pointer}
  .chip.active{background:#274163;color:#eaf2ff}
  .group{margin-top:12px;border:1px solid var(--stroke);border-radius:14px;overflow:hidden}
  .group h2{margin:0;padding:10px 14px;background:#0f1c30;border-bottom:1px solid var(--stroke);font-size:15px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;padding:12px}
  .card{background:var(--card);border:1px solid var(--stroke);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:6px;min-height:118px}
  .card h3{margin:0 0 2px;font-size:16px}
  .card p{margin:0;color:var(--muted);font-size:14px}
  .meta{display:flex;gap:8px;flex-wrap:wrap;margin-top:auto}
  .tag{font-size:11px;background:#0e1b32;border:1px solid #21324f;color:#c9d6eb;padding:3px 8px;border-radius:999px}
  .star{margin-left:auto;cursor:pointer}
  .star[data-active="true"]{color:#ffd166}
  details.tools{background:#0f1c30;border:1px solid var(--stroke);border-radius:12px;padding:12px;margin-top:12px}
  footer{margin:26px 0;color:var(--muted);font-size:13px}
  .hidden{display:none}
  .kbd{border:1px solid #334766;border-radius:6px;padding:2px 6px;background:#0f1c30;color:#cbd5e1;font-size:12px}
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="hgroup">
      <div style="font-size:26px">‚úàÔ∏è</div>
      <div>
        <h1>Grupo de Estrat√©gias Avan√ßadas de Milhas</h1>
        <div class="sub">Hub est√°tico por <strong>t√≥picos</strong> ‚Äî curadoria de sites, pesquisas, programas, ferramentas e promo√ß√µes.</div>
      </div>
    </div>
    <div class="toolbar">
      <button class="btn brand" id="toggleTheme">Alternar tema</button>
      <button class="btn" id="showFavorites">‚≠ê Favoritos</button>
      <button class="btn" id="addBtn">+ Adicionar link</button>
      <button class="btn" id="exportBtn">Exportar</button>
      <button class="btn" id="importBtn">Importar</button>
    </div>
  </header>

  <div class="searchbar">
    <span>üîé</span>
    <input id="searchInput" placeholder="Buscar por nome, descri√ß√£o, tag ou subt√≥pico (ex.: 'Smiles', 'sweet spot', 'Star Alliance')"/>
    <span class="kbd">/</span>
  </div>

  <div class="tabs" id="tabs"></div>
  <div class="chips" id="chips"></div>

  <div id="groups"></div>

  <details class="tools">
    <summary><strong>Atalhos √∫teis</strong></summary>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
      <a class="btn" href="https://www.google.com/travel/flights" target="_blank" rel="noopener">Google Flights</a>
      <a class="btn" href="https://matrix.itasoftware.com" target="_blank" rel="noopener">ITA Matrix</a>
      <a class="btn" href="https://seats.aero" target="_blank" rel="noopener">Seats.aero</a>
      <a class="btn" href="https://awardwallet.com" target="_blank" rel="noopener">AwardWallet</a>
      <a class="btn" href="https://www.expertflyer.com/" target="_blank" rel="noopener">ExpertFlyer</a>
      <a class="btn" href="https://point.me" target="_blank" rel="noopener">Point.Me</a>
      <a class="btn" href="https://www.gcmap.com/" target="_blank" rel="noopener">Great Circle Mapper</a>
      <a class="btn" href="https://www.skyscanner.com.br" target="_blank" rel="noopener">Skyscanner</a>
    </div>
  </details>

  <footer>
    <div>üí° P√°gina 100% est√°tica (HTML/CSS/JS). Favoritos e links adicionados ficam no seu navegador (LocalStorage).</div>
    <div>‚úçÔ∏è Personalize com <em>+ Adicionar link</em> ou <em>Exportar</em> para compartilhar a curadoria.</div>
  </footer>
</div>

<!-- Modal -->
<div id="modal" class="hidden" style="position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;padding:16px;z-index:20">
  <div style="width:min(900px,95vw);background:#0b1220;border:1px solid #22324f;border-radius:14px;padding:16px">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:8px">
      <h3 id="modalTitle" style="margin:0">Modal</h3>
      <button class="btn" id="closeModal">Fechar</button>
    </div>
    <div id="modalBody"></div>
  </div>
</div>

<script>
/* ===== 1) T√ìPICOS, SUBT√ìPICOS & LINKS (curadoria) ===== */
const DATA = {
  topicos: [
    "Destaques üáßüá∑",
    "Estrat√©gias de Emiss√£o",
    "Programas & Alian√ßas",
    "Transfer√™ncias & Cart√µes",
    "Ferramentas de Busca",
    "Hot√©is & Parceiros",
    "Alertas & Promo√ß√µes",
    "Pesquisas & Comunidades",
    "Regras & Pol√≠ticas",
    "Tutoriais & Guias",
    "Planilhas & Templates"
  ],
  tags: [
    "Brasil","Alian√ßas","Star Alliance","Oneworld","SkyTeam",
    "Sweet spot","Stopover","Open-jaw","Status match","Upgrade",
    "Transfer√™ncia","Avios","Promo","Ferramenta","Guia"
  ],
  links: [
    /* --- Destaques üáßüá∑ --- */
    {t:"Passageiro de Primeira",d:"Blog de refer√™ncia no Brasil (reviews, estrat√©gias, cart√µes).",u:"https://passageirodeprimeira.com/",top:"Destaques üáßüá∑",sub:"Portais BR",tags:["Brasil","Guia"]},
    {t:"Pontos pra Voar",d:"An√°lises, not√≠cias e comparativos de programas.",u:"https://www.pontospravoar.com/",top:"Destaques üáßüá∑",sub:"Portais BR",tags:["Brasil","Guia"]},
    {t:"Melhores Destinos",d:"Alertas de passagens baratas e promo√ß√µes.",u:"https://www.melhoresdestinos.com.br/",top:"Destaques üáßüá∑",sub:"Portais BR",tags:["Brasil","Promo"]},
    {t:"Mestre das Milhas",d:"Conte√∫do cl√°ssico sobre programas e emiss√µes.",u:"https://www.mestredasmilhas.com/",top:"Destaques üáßüá∑",sub:"Portais BR",tags:["Brasil","Guia"]},
    {t:"Falando de Viagem",d:"Dicas, relatos e comparativos.",u:"https://www.falandodeviagem.com.br/",top:"Destaques üáßüá∑",sub:"Portais BR",tags:["Brasil","Guia"]},

    /* --- Estrat√©gias de Emiss√£o --- */
    {t:"Sweet spots (refer√™ncias)",d:"Coleta de ideias de rotas de alto valor.",u:"https://www.google.com/search?q=sweet+spots+award+travel",top:"Estrat√©gias de Emiss√£o",sub:"Fundamentos",tags:["Sweet spot","Guia"]},
    {t:"Stopover & Open-jaw",d:"Conceitos para maximizar um bilhete.",u:"https://www.google.com/search?q=stopover+open+jaw+award",top:"Estrat√©gias de Emiss√£o",sub:"Fundamentos",tags:["Stopover","Open-jaw","Guia"]},
    {t:"Status Match & Challenge",d:"Como obter/status com match ou desafio.",u:"https://www.google.com/search?q=status+match+airlines",top:"Estrat√©gias de Emiss√£o",sub:"Status",tags:["Status match","Guia"]},
    {t:"Upgrades com milhas",d:"Regras de upgrades por companhia/programa.",u:"https://www.google.com/search?q=airline+upgrade+with+miles+rules",top:"Estrat√©gias de Emiss√£o",sub:"Upgrades",tags:["Upgrade","Guia"]},

    /* --- Programas & Alian√ßas --- */
    {t:"Smiles (GOL)",d:"Programa brasileiro. Emiss√µes parceiras e voos GOL.",u:"https://www.smiles.com.br/",top:"Programas & Alian√ßas",sub:"Programas Brasileiros",tags:["Brasil"]},
    {t:"LATAM Pass",d:"Programa LATAM; parceiros oneworld/avios (via IB/BA).",u:"https://www.latampass.com/pt_br/",top:"Programas & Alian√ßas",sub:"Programas Brasileiros",tags:["Brasil","Oneworld"]},
    {t:"TudoAzul (AZUL)",d:"Programa da Azul; parcerias estrat√©gicas.",u:"https://tudoazul.voeazul.com.br/web/tudoazul",top:"Programas & Alian√ßas",sub:"Programas Brasileiros",tags:["Brasil"]},
    {t:"TAP Miles&Go",d:"Programa Star (PT); boas oportunidades.",u:"https://www.flytap.com/pt-br/miles-and-go",top:"Programas & Alian√ßas",sub:"Star Alliance",tags:["Star Alliance"]},
    {t:"Avianca LifeMiles",d:"V√°rios sweet spots em parceiros Star.",u:"https://www.lifemiles.com/",top:"Programas & Alian√ßas",sub:"Star Alliance",tags:["Star Alliance","Sweet spot"]},
    {t:"United MileagePlus",d:"Busca robusta na Star.",u:"https://www.united.com/en/us/frequent-flyer/overview",top:"Programas & Alian√ßas",sub:"Star Alliance",tags:["Star Alliance"]},
    {t:"Turkish Miles&Smiles",d:"Tabela Star com bons valores.",u:"https://www.turkishairlines.com/en-int/miles-and-smiles/",top:"Programas & Alian√ßas",sub:"Star Alliance",tags:["Star Alliance"]},
    {t:"British Airways Executive Club",d:"Avios por dist√¢ncia; emiss√µes curtas.",u:"https://www.britishairways.com/en-us/executive-club",top:"Programas & Alian√ßas",sub:"Oneworld/Avios",tags:["Oneworld","Avios"]},
    {t:"Iberia Plus",d:"Avios; √≥timos valores ib√©ricos e pontes.",u:"https://www.iberia.com/pt/iberiaplus/",top:"Programas & Alian√ßas",sub:"Oneworld/Avios",tags:["Oneworld","Avios"]},
    {t:"Qatar Airways Privilege Club",d:"Avios integrados (transfer BA/IB).",u:"https://www.qatarairways.com/en/Privilege-Club.html",top:"Programas & Alian√ßas",sub:"Oneworld/Avios",tags:["Oneworld","Avios"]},
    {t:"Flying Blue (AF/KLM)",d:"Promo Rewards mensais; SkyTeam.",u:"https://www.flyingblue.com/",top:"Programas & Alian√ßas",sub:"SkyTeam",tags:["SkyTeam","Promo"]},
    {t:"Delta SkyMiles",d:"Tabela din√¢mica; rede SkyTeam.",u:"https://www.delta.com/skymiles",top:"Programas & Alian√ßas",sub:"SkyTeam",tags:["SkyTeam"]},

    /* --- Transfer√™ncias & Cart√µes --- */
    {t:"Rotas de transfer√™ncia (pesquisa)",d:"Parceiros banco ‚Üí programa (BR/EUA/EU).",u:"https://www.google.com/search?q=bank+points+transfer+partners",top:"Transfer√™ncias & Cart√µes",sub:"Panorama",tags:["Transfer√™ncia"]},
    {t:"Avios ‚Äî mover entre carteiras",d:"BA/IB/QR/AE (como transferir).",u:"https://www.google.com/search?q=move+transfer+avios+between+iberia+british+qatar",top:"Transfer√™ncias & Cart√µes",sub:"Avios",tags:["Avios","Transfer√™ncia"]},
    {t:"Livelo (BR)",d:"Parceiros e prazos de cr√©dito.",u:"https://www.livelo.com.br/partners",top:"Transfer√™ncias & Cart√µes",sub:"Brasil",tags:["Transfer√™ncia"]},
    {t:"Esfera (BR)",d:"Campanhas e parceiros.",u:"https://www.esfera.com.vc/",top:"Transfer√™ncias & Cart√µes",sub:"Brasil",tags:["Transfer√™ncia"]},
    {t:"iupp/porto/itaucard (BR)",d:"Ecossistemas de pontos/cart√µes.",u:"https://www.google.com/search?q=parceiros+transferencia+pontos+cartoes+brasil",top:"Transfer√™ncias & Cart√µes",sub:"Brasil",tags:["Transfer√™ncia"]},

    /* --- Ferramentas de Busca --- */
    {t:"Google Flights",d:"Matriz de datas/pre√ßos (cash).",u:"https://www.google.com/travel/flights",top:"Ferramentas de Busca",sub:"Metabusca",tags:["Ferramenta"]},
    {t:"Skyscanner",d:"Busca ampla por rotas.",u:"https://www.skyscanner.com.br",top:"Ferramentas de Busca",sub:"Metabusca",tags:["Ferramenta"]},
    {t:"ITA Matrix",d:"Busca avan√ßada (c√≥digos/filters).",u:"https://matrix.itasoftware.com",top:"Ferramentas de Busca",sub:"Avan√ßado",tags:["Ferramenta"]},
    {t:"Seats.aero",d:"Achados r√°pidos de pr√™mio.",u:"https://seats.aero",top:"Ferramentas de Busca",sub:"Pr√™mios",tags:["Ferramenta"]},
    {t:"Point.Me",d:"Planner de emiss√µes com milhas.",u:"https://point.me",top:"Ferramentas de Busca",sub:"Pr√™mios",tags:["Ferramenta"]},
    {t:"ExpertFlyer",d:"Invent√°rio/assentos/alertas (pago).",u:"https://www.expertflyer.com/",top:"Ferramentas de Busca",sub:"Avan√ßado",tags:["Ferramenta"]},
    {t:"AwardWallet",d:"Controle de saldos/alertas de validade.",u:"https://awardwallet.com",top:"Ferramentas de Busca",sub:"Gest√£o de contas",tags:["Ferramenta"]},
    {t:"Great Circle Mapper",d:"Rotas e dist√¢ncias.",u:"https://www.gcmap.com/",top:"Ferramentas de Busca",sub:"Mapas & dist√¢ncias",tags:["Ferramenta"]},

    /* --- Hot√©is & Parceiros --- */
    {t:"Marriott Bonvoy",d:"Programa de hot√©is; transfer√™ncias.",u:"https://www.marriott.com/loyalty.mi",top:"Hot√©is & Parceiros",sub:"Hot√©is",tags:["Transfer√™ncia"]},
    {t:"World of Hyatt",d:"√ìtima tabela pr√™mio.",u:"https://world.hyatt.com/",top:"Hot√©is & Parceiros",sub:"Hot√©is",tags:["Sweet spot"]},
    {t:"Hilton Honors",d:"Rede extensa; promo√ß√µes frequentes.",u:"https://www.hilton.com/en/hilton-honors/",top:"Hot√©is & Parceiros",sub:"Hot√©is",tags:[]},
    {t:"IHG One Rewards",d:"Rede IHG (InterContinental, etc.).",u:"https://www.ihg.com/onerewards/content/us/en/home",top:"Hot√©is & Parceiros",sub:"Hot√©is",tags:[]},
    {t:"ALL ‚Äì Accor Live Limitless",d:"Programa com presen√ßa forte no BR.",u:"https://all.accor.com/loyalty-program/reasonstojoin/index.en.shtml",top:"Hot√©is & Parceiros",sub:"Hot√©is",tags:[]},
    {t:"Carros ‚Äî ganhar milhas",d:"Parceiros (Avis, Budget, etc.).",u:"https://www.google.com/search?q=car+rentals+earn+airline+miles+partners",top:"Hot√©is & Parceiros",sub:"Carros",tags:[]},

    /* --- Alertas & Promo√ß√µes --- */
    {t:"Promo√ß√µes Flying Blue",d:"Ofertas mensais com milhas reduzidas.",u:"https://www.flyingblue.com/en/promo-rewards",top:"Alertas & Promo√ß√µes",sub:"Parceiros Internacionais",tags:["Promo","SkyTeam"]},
    {t:"Promo√ß√µes Smiles",d:"B√¥nus de transfer√™ncia e emiss√µes.",u:"https://www.smiles.com.br/promocoes",top:"Alertas & Promo√ß√µes",sub:"Brasil",tags:["Brasil","Promo"]},
    {t:"Ofertas LATAM Pass",d:"Campanhas e oportunidades LATAM.",u:"https://www.latampass.com/pt_br/ofertas",top:"Alertas & Promo√ß√µes",sub:"Brasil",tags:["Brasil","Promo"]},
    {t:"Ofertas TudoAzul",d:"Campanhas do programa Azul.",u:"https://tudoazul.voeazul.com.br/web/tudoazul/promocao",top:"Alertas & Promo√ß√µes",sub:"Brasil",tags:["Brasil","Promo"]},
    {t:"Passagens Promo",d:"Ofertas e cupons (BR).",u:"https://www.passagenspromo.com.br/",top:"Alertas & Promo√ß√µes",sub:"Brasil",tags:["Brasil","Promo"]},
    {t:"Passagens Imperd√≠veis",d:"Achados e tarifas baixas (BR).",u:"https://www.passagensimperdiveis.com.br/",top:"Alertas & Promo√ß√µes",sub:"Brasil",tags:["Brasil","Promo"]},

    /* --- Pesquisas & Comunidades --- */
    {t:"FlyerTalk",d:"F√≥rum cl√°ssico de milhas e cias.",u:"https://www.flyertalk.com/forum/",top:"Pesquisas & Comunidades",sub:"Comunidades",tags:["Guia"]},
    {t:"Reddit r/awardtravel",d:"Discuss√µes e achados.",u:"https://www.reddit.com/r/awardtravel/",top:"Pesquisas & Comunidades",sub:"Comunidades",tags:["Guia"]},
    {t:"One Mile at a Time",d:"Reviews e estrat√©gias (EN).",u:"https://onemileatatime.com/",top:"Pesquisas & Comunidades",sub:"Portais EN",tags:["Guia"]},
    {t:"The Points Guy",d:"Guias e not√≠cias (EN).",u:"https://thepointsguy.com/",top:"Pesquisas & Comunidades",sub:"Portais EN",tags:["Guia"]},

    /* --- Regras & Pol√≠ticas --- */
    {t:"Regras de Bagagem (busca)",d:"Compare pol√≠ticas por cia/rota.",u:"https://www.google.com/search?q=baggage+policy+airlines",top:"Regras & Pol√≠ticas",sub:"Bagagem",tags:[]},
    {t:"Award charts (listas)",d:"Colet√¢neas de tabelas de emiss√£o.",u:"https://www.google.com/search?q=award+chart+list",top:"Regras & Pol√≠ticas",sub:"Tabelas",tags:["Sweet spot"]},
    {t:"Direitos do Passageiro ‚Äî ANAC (BR)",d:"Regras e assist√™ncia ao passageiro.",u:"https://www.gov.br/anac/pt-br/assuntos/passageiros",top:"Regras & Pol√≠ticas",sub:"Direitos do Passageiro",tags:["Brasil"]},
    {t:"EU261 ‚Äî Direitos na UE",d:"Reembolsos e compensa√ß√µes na Uni√£o Europeia.",u:"https://europa.eu/youreurope/citizens/travel/passenger-rights/air/index_pt.htm",top:"Regras & Pol√≠ticas",sub:"Direitos do Passageiro",tags:[]},

    /* --- Tutoriais & Guias --- */
    {t:"Buscar disponibilidade pr√™mio",d:"Fluxo de pesquisa passo a passo.",u:"https://www.google.com/search?q=how+to+search+award+availability",top:"Tutoriais & Guias",sub:"Pesquisa",tags:["Guia"]},
    {t:"Emitindo com Avios",d:"Exemplos pr√°ticos (BA/IB/QR).",u:"https://www.google.com/search?q=how+to+book+with+avios",top:"Tutoriais & Guias",sub:"Avios",tags:["Guia","Avios"]},
    {t:"Emitindo Star (United/LifeMiles)",d:"T√©cnicas para encontrar assentos.",u:"https://www.google.com/search?q=how+to+book+united+lifemiles+award",top:"Tutoriais & Guias",sub:"Star Alliance",tags:["Guia","Star Alliance"]},

    /* --- Planilhas & Templates --- */
    {t:"Templates de controle",d:"Planilhas para planejar emiss√µes.",u:"https://www.google.com/search?q=award+travel+spreadsheet+template",top:"Planilhas & Templates",sub:"Planilhas",tags:["Ferramenta"]},
    {t:"Calculadora de dist√¢ncias (GCMap)",d:"Base para programas por dist√¢ncia.",u:"https://www.gcmap.com/",top:"Planilhas & Templates",sub:"C√°lculo",tags:["Ferramenta"]}
  ]
};

/* ===== 2) ESTADO/LS ===== */
const $ = sel => document.querySelector(sel);
const LS = { favorites:"mileshub:favorites", custom:"mileshub:customLinks", theme:"mileshub:theme" };
let state = { topico: DATA.topicos[0], tag: null, query: "", onlyFav:false };

const load = (k,f)=>{ try{return JSON.parse(localStorage.getItem(k)) ?? f;}catch(e){return f;} };
const save = (k,v)=>localStorage.setItem(k,JSON.stringify(v));
const favorites = ()=> new Set(load(LS.favorites, []));
const allLinks = ()=> [...DATA.links, ...load(LS.custom, [])];

/* ===== 3) RENDER ===== */
function renderTabs(){
  const el = $("#tabs"); el.innerHTML = "";
  DATA.topicos.forEach(t=>{
    const b = document.createElement("button");
    b.className = "tab"+(state.topico===t?" active":"");
    b.textContent = t;
    b.onclick = ()=>{ state.topico=t; state.tag=null; state.query=""; render(); window.scrollTo({top:0,behavior:"smooth"}); };
    el.appendChild(b);
  });
}
function renderChips(){
  const el = $("#chips"); el.innerHTML = "";
  const arr = ["Todos", ...DATA.tags];
  arr.forEach(t=>{
    const c = document.createElement("div");
    c.className = "chip"+((!state.tag && t==="Todos") || state.tag===t ? " active":"");
    c.textContent = t;
    c.onclick = ()=>{ state.tag = (t==="Todos")? null : t; render(); };
    el.appendChild(c);
  });
}
function matchQuery(l,q){
  if(!q) return true;
  const s = (l.t+" "+(l.d||"")+" "+(l.tags||[]).join(" ")+" "+(l.sub||"")).toLowerCase();
  return s.includes(q.toLowerCase());
}
function groupBySubtopic(links){
  const map = new Map();
  links.forEach(l=>{
    const key = l.sub || "Outros";
    if(!map.has(key)) map.set(key, []);
    map.get(key).push(l);
  });
  return [...map.entries()].sort((a,b)=>a[0].localeCompare(b[0],'pt-BR'));
}
function renderGroups(){
  const wrap = $("#groups"); wrap.innerHTML = "";
  const favs = favorites();
  let links = allLinks().filter(l=>l.top===state.topico);
  if(state.tag) links = links.filter(l=>(l.tags||[]).includes(state.tag));
  if(state.query) links = links.filter(l=>matchQuery(l, state.query));
  if(state.onlyFav) links = links.filter(l=>favs.has(l.u));

  links.sort((a,b)=>{
    const fa=favs.has(a.u), fb=favs.has(b.u);
    if(fa!==fb) return fa?-1:1;
    return a.t.localeCompare(b.t,'pt-BR');
  });

  const groups = groupBySubtopic(links);
  if(groups.length===0){
    const empty = document.createElement("div");
    empty.style.cssText = "opacity:.85;padding:12px;border:1px dashed #2b3b55;border-radius:12px";
    empty.textContent = "Nenhum link encontrado para os filtros atuais.";
    wrap.appendChild(empty);
    return;
  }

  groups.forEach(([sub, items])=>{
    const section = document.createElement("section");
    section.className = "group";
    section.innerHTML = `<h2>${sub}</h2><div class="grid"></div>`;
    const grid = section.querySelector(".grid");
    items.forEach(l=>{
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <h3><a href="${l.u}" target="_blank" rel="noopener noreferrer">${l.t}</a></h3>
        <p>${l.d||""}</p>
        <div class="meta">
          ${(l.tags||[]).map(t=>`<span class="tag">${t}</span>`).join("")}
          <span class="star" title="Favoritar" role="button" data-url="${l.u}" data-active="${favs.has(l.u)}">‚≠ê</span>
        </div>
      `;
      card.querySelector(".star").onclick = (e)=>toggleFavorite(e.target.dataset.url);
      grid.appendChild(card);
    });
    wrap.appendChild(section);
  });
}
function render(){ renderTabs(); renderChips(); renderGroups(); }

/* ===== 4) A√á√ïES ===== */
$("#searchInput").addEventListener("input",(e)=>{ state.query=e.target.value; render(); });
document.addEventListener("keydown",(e)=>{ if(e.key==="/"){ e.preventDefault(); $("#searchInput").focus(); }});
$("#toggleTheme").onclick = ()=>{
  const curr = load(LS.theme,"dark");
  const next = curr==="dark" ? "light":"dark";
  document.body.style.background = next==="light" ? "#f4f7fb" : "var(--bg)";
  save(LS.theme,next);
};
function toggleFavorite(url){
  const fav = favorites();
  fav.has(url)? fav.delete(url) : fav.add(url);
  save(LS.favorites,[...fav]); render();
}
$("#showFavorites").onclick = ()=>{
  state.onlyFav = !state.onlyFav;
  $("#showFavorites").textContent = state.onlyFav ? "‚≠ê Apenas favoritos" : "‚≠ê Favoritos";
  render();
};

/* ===== 5) Importar / Exportar / Adicionar ===== */
const modal = $("#modal");
const openModal=(title,body)=>{ $("#modalTitle").textContent=title; $("#modalBody").innerHTML=body; modal.classList.remove("hidden"); };
$("#closeModal").onclick = ()=>modal.classList.add("hidden");
modal.addEventListener("click",(e)=>{ if(e.target===modal) modal.classList.add("hidden"); });

$("#exportBtn").onclick = ()=>{
  const payload = { custom: load(LS.custom,[]), favorites:[...favorites()], version:3 };
  openModal("Exportar (JSON)", `
    <p>Copie o JSON abaixo para salvar/compartilhar. Depois use <em>Importar</em> para carregar.</p>
    <textarea style="width:100%;height:260px;background:#0f1c30;color:#e7eef6;border:1px solid #22324f;border-radius:8px;padding:8px">${JSON.stringify(payload,null,2)}</textarea>
  `);
};
$("#importBtn").onclick = ()=>{
  openModal("Importar (JSON)", `
    <p>Cole o JSON exportado anteriormente e clique em <strong>Importar</strong>.</p>
    <textarea id="importArea" style="width:100%;height:220px;background:#0f1c30;color:#e7eef6;border:1px solid #22324f;border-radius:8px;padding:8px"></textarea>
    <div style="margin-top:8px;display:flex;gap:8px;justify-content:flex-end">
      <button class="btn" id="cancelImport">Cancelar</button>
      <button class="btn brand" id="doImport">Importar</button>
    </div>
  `);
  $("#cancelImport").onclick = ()=>modal.classList.add("hidden");
  $("#doImport").onclick = ()=>{
    try{
      const obj = JSON.parse($("#importArea").value);
      if(obj.custom) save(LS.custom, obj.custom);
      if(obj.favorites) save(LS.favorites, obj.favorites);
      modal.classList.add("hidden"); render(); alert("Importado com sucesso!");
    }catch(e){ alert("JSON inv√°lido."); }
  };
};
$("#addBtn").onclick = ()=>{
  openModal("Adicionar link ao t√≥pico", `
    <div style="display:grid;gap:8px;grid-template-columns:1fr 1fr">
      <label>T√≠tulo<br/><input id="fTitle" style="width:100%;padding:8px;border-radius:8px;border:1px solid #22324f;background:#0f1c30;color:#e7eef8"/></label>
      <label>URL<br/><input id="fURL" style="width:100%;padding:8px;border-radius:8px;border:1px solid #22324f;background:#0f1c30;color:#e7eef8" placeholder="https://..."/></label>
    </div>
    <label style="display:block;margin-top:8px">Descri√ß√£o<br/><input id="fDesc" style="width:100%;padding:8px;border-radius:8px;border:1px solid #22324f;background:#0f1c30;color:#e7eef8"/></label>
    <div style="display:grid;gap:8px;grid-template-columns:1fr 1fr;margin-top:8px">
      <label>T√≥pico<br/>
        <select id="fTop" style="width:100%;padding:8px;border-radius:8px;border:1px solid #22324f;background:#0f1c30;color:#e7eef8">
          ${DATA.topicos.map(t=>`<option>${t}</option>`).join("")}
        </select>
      </label>
      <label>Subt√≥pico<br/><input id="fSub" style="width:100%;padding:8px;border-radius:8px;border:1px solid #22324f;background:#0f1c30;color:#e7eef8" placeholder="ex.: Programas Brasileiros"/></label>
    </div>
    <label style="display:block;margin-top:8px">Tags (separe por v√≠rgula)<br/><input id="fTags" style="width:100%;padding:8px;border-radius:8px;border:1px solid #22324f;background:#0f1c30;color:#e7eef8" placeholder="Brasil, Promo, Star Alliance, Avios"/></label>
    <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px">
      <button class="btn" id="cancelAdd">Cancelar</button>
      <button class="btn brand" id="saveAdd">Salvar</button>
    </div>
  `);
  $("#cancelAdd").onclick = ()=>modal.classList.add("hidden");
  $("#saveAdd").onclick = ()=>{
    const t = $("#fTitle").value.trim();
    const u = $("#fURL").value.trim();
    if(!t || !u){ alert("T√≠tulo e URL s√£o obrigat√≥rios."); return; }
    const item = {
      t, u,
      d: $("#fDesc").value.trim(),
      top: $("#fTop").value,
      sub: ($("#fSub").value.trim() || "Outros"),
      tags: $("#fTags").value.split(",").map(s=>s.trim()).filter(Boolean)
    };
    const custom = load(LS.custom, []);
    custom.push(item); save(LS.custom, custom);
    modal.classList.add("hidden");
    state.topico = item.top; state.tag=null; state.query="";
    render();
  };
};

/* ===== 6) INIT ===== */
(function init(){
  document.body.style.background = load(LS.theme,"dark")==="light" ? "#f4f7fb" : "var(--bg)";
  render();
})();
</script>
</body>
</html>
